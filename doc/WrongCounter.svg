<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/PR-SVG-20010719/DTD/svg10.dtd">
<svg width="20cm" height="23cm" viewBox="116 55 383 444" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="222.976" y1="102" x2="224" y2="498"/>
  <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="424.976" y1="102" x2="424" y2="498"/>
  <g>
    <g>
      <rect style="fill: #ffffff" x="386.974" y="56.8" width="77" height="46"/>
      <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="386.974" y="56.8" width="77" height="46"/>
    </g>
    <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="400.832" y="84.875">
      <tspan x="400.832" y="84.875">Gateway</tspan>
    </text>
  </g>
  <g>
    <g>
      <rect style="fill: #ffffff" x="184.975" y="56.8" width="77" height="46"/>
      <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="184.975" y="56.8" width="77" height="46"/>
    </g>
    <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="208.606" y="84.875">
      <tspan x="208.606" y="84.875">Node</tspan>
    </text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="224.476" y1="356" x2="416.74" y2="356.952"/>
    <polygon style="fill: #000000" points="424.24,356.989 414.215,361.939 416.74,356.952 414.265,351.939 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="424.24,356.989 414.215,361.939 416.74,356.952 414.265,351.939 "/>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="256.476" y="349">
    <tspan x="256.476" y="349">ClientHello (unencrypted)</tspan>
  </text>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="426.474" y1="381" x2="234.21" y2="380.048"/>
    <polygon style="fill: #000000" points="226.71,380.011 236.735,375.061 234.21,380.048 236.685,385.061 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="226.71,380.011 236.735,375.061 234.21,380.048 236.685,385.061 "/>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="255.476" y="374">
    <tspan x="255.476" y="374">ServerHello (unencrypted)</tspan>
  </text>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="222.98" y1="162.097" x2="415.244" y2="163.048"/>
    <polygon style="fill: #000000" points="422.744,163.086 412.719,168.036 415.244,163.048 412.769,158.036 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="422.744,163.086 412.719,168.036 415.244,163.048 412.769,158.036 "/>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="275.976" y="154.6">
    <tspan x="275.976" y="154.6">Data (encrypted)</tspan>
  </text>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="223.98" y1="209.096" x2="416.244" y2="210.048"/>
    <polygon style="fill: #000000" points="423.744,210.085 413.719,215.035 416.244,210.048 413.769,205.035 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="423.744,210.085 413.719,215.035 416.244,210.048 413.769,205.035 "/>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="276.976" y="201.6">
    <tspan x="276.976" y="201.6">Data (encrypted)</tspan>
  </text>
  <g>
    <rect style="fill: #ffffff" x="117.5" y="115" width="96.55" height="54"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="117.5" y="115" width="96.55" height="54"/>
    <text font-size="12.8" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="165.775" y="138.8">
      <tspan x="165.775" y="138.8">Node already</tspan>
      <tspan x="165.775" y="154.8">registered</tspan>
    </text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="426.212" y1="311.6" x2="233.948" y2="310.648"/>
    <polygon style="fill: #000000" points="226.448,310.611 236.473,305.661 233.948,310.648 236.423,315.661 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="226.448,310.611 236.473,305.661 233.948,310.648 236.423,315.661 "/>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="255.212" y="304.6">
    <tspan x="255.212" y="304.6">InvalidateKey (unencrypted)</tspan>
  </text>
  <g>
    <rect style="fill: #ffffff" x="127.45" y="293" width="86.05" height="54"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="127.45" y="293" width="86.05" height="54"/>
    <text font-size="12.8" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="170.475" y="316.8">
      <tspan x="170.475" y="316.8">Start new</tspan>
      <tspan x="170.475" y="332.8">registration</tspan>
    </text>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="265.476" y="326">
    <tspan x="265.476" y="326">Reason: wrong data</tspan>
  </text>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="280" y="175">
    <tspan x="280" y="175">Counter = 35</tspan>
  </text>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="280.5" y="222.6">
    <tspan x="280.5" y="222.6">Counter = 36</tspan>
  </text>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="223.504" y1="252.096" x2="415.768" y2="253.048"/>
    <polygon style="fill: #000000" points="423.268,253.085 413.243,258.035 415.768,253.048 413.293,248.035 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="423.268,253.085 413.243,258.035 415.768,253.048 413.293,248.035 "/>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="276.5" y="244.6">
    <tspan x="276.5" y="244.6">Data (encrypted)</tspan>
  </text>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="280.024" y="268.6">
    <tspan x="280.024" y="268.6">Counter = 1</tspan>
  </text>
  <g>
    <rect style="fill: #ffffff" x="433.6" y="242" width="64.8" height="54"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="433.6" y="242" width="64.8" height="54"/>
    <text font-size="12.8" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="466" y="265.8">
      <tspan x="466" y="265.8">Wrong</tspan>
      <tspan x="466" y="281.8">counter</tspan>
    </text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="223.504" y1="404.696" x2="415.768" y2="405.648"/>
    <polygon style="fill: #000000" points="423.268,405.685 413.243,410.635 415.768,405.648 413.293,400.635 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="423.268,405.685 413.243,410.635 415.768,405.648 413.293,400.635 "/>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="229" y="397.6">
    <tspan x="229" y="397.6">KeyExchangeFinished (encrypted)</tspan>
  </text>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="424.736" y1="431.2" x2="232.472" y2="430.248"/>
    <polygon style="fill: #000000" points="224.972,430.211 234.997,425.261 232.472,430.248 234.947,435.261 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="224.972,430.211 234.997,425.261 232.472,430.248 234.947,435.261 "/>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="245.736" y="424.2">
    <tspan x="245.736" y="424.2">CypherFinished (encrypted)</tspan>
  </text>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="223.504" y1="474.096" x2="415.768" y2="475.048"/>
    <polygon style="fill: #000000" points="423.268,475.085 413.243,480.035 415.768,475.048 413.293,470.035 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="423.268,475.085 413.243,480.035 415.768,475.048 413.293,470.035 "/>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="257.5" y="467.6">
    <tspan x="257.5" y="467.6">Resend Data (encrypted)</tspan>
  </text>
</svg>
