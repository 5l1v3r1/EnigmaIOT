<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/PR-SVG-20010719/DTD/svg10.dtd">
<svg width="22cm" height="24cm" viewBox="249 92 423 466" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <g>
    <rect style="fill: #ffffff" x="250.5" y="155" width="98" height="27"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="250.5" y="155" width="98" height="27"/>
  </g>
  <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="356.5" y1="139" x2="357" y2="540"/>
  <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="558.5" y1="139" x2="559" y2="543"/>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="258.05" y="172">
    <tspan x="258.05" y="172">Node is started</tspan>
  </text>
  <g>
    <g>
      <rect style="fill: #ffffff" x="520.5" y="93.8" width="77" height="46"/>
      <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="520.5" y="93.8" width="77" height="46"/>
    </g>
    <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="534.356" y="121.875">
      <tspan x="534.356" y="121.875">Gateway</tspan>
    </text>
  </g>
  <g>
    <g>
      <rect style="fill: #ffffff" x="318.5" y="93.8" width="77" height="46"/>
      <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="318.5" y="93.8" width="77" height="46"/>
    </g>
    <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="342.132" y="121.875">
      <tspan x="342.132" y="121.875">Node</tspan>
    </text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="357" y1="190" x2="549.264" y2="190.952"/>
    <polygon style="fill: #000000" points="556.764,190.989 546.739,195.939 549.264,190.952 546.789,185.939 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="556.764,190.989 546.739,195.939 549.264,190.952 546.789,185.939 "/>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="389" y="183">
    <tspan x="389" y="183">ClientHello (unencrypted)</tspan>
  </text>
  <g>
    <rect style="fill: #ffffff" x="569.5" y="194.8" width="98" height="27"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="569.5" y="194.8" width="98" height="27"/>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="577.5" y="211.8">
    <tspan x="577.5" y="211.8">Key Calculation</tspan>
  </text>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="560" y1="227" x2="367.736" y2="226.048"/>
    <polygon style="fill: #000000" points="360.236,226.011 370.261,221.061 367.736,226.048 370.211,231.061 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="360.236,226.011 370.261,221.061 367.736,226.048 370.211,231.061 "/>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="389" y="220">
    <tspan x="389" y="220">ServerHello (unencrypted)</tspan>
  </text>
  <g>
    <rect style="fill: #ffffff" x="250.5" y="234.8" width="98" height="27"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="250.5" y="234.8" width="98" height="27"/>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="256.4" y="253.8">
    <tspan x="256.4" y="253.8">Key Calculation</tspan>
  </text>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="357.504" y1="273.096" x2="549.768" y2="274.048"/>
    <polygon style="fill: #000000" points="557.268,274.085 547.243,279.035 549.768,274.048 547.293,269.035 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="557.268,274.085 547.243,279.035 549.768,274.048 547.293,269.035 "/>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="363" y="266">
    <tspan x="363" y="266">KeyExchangeFinished (encrypted)</tspan>
  </text>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="558.736" y1="316.6" x2="366.472" y2="315.648"/>
    <polygon style="fill: #000000" points="358.972,315.611 368.997,310.661 366.472,315.648 368.947,320.661 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="358.972,315.611 368.997,310.661 366.472,315.648 368.947,320.661 "/>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="379.736" y="309.6">
    <tspan x="379.736" y="309.6">CypherFinished (encrypted)</tspan>
  </text>
  <g>
    <rect style="fill: #ffffff" x="573.5" y="281" width="98" height="44"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="573.5" y="281" width="98" height="44"/>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="622.5" y="297">
    <tspan x="622.5" y="297">Check key</tspan>
    <tspan x="622.5" y="313">Node registered</tspan>
  </text>
  <g>
    <rect style="fill: #ffffff" x="251.5" y="323" width="98" height="43"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="251.5" y="323" width="98" height="43"/>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="302.582" y="341.8">
    <tspan x="302.582" y="341.8">Check key</tspan>
    <tspan x="302.582" y="357.8">Registration OK</tspan>
  </text>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="356.504" y1="398.096" x2="548.768" y2="399.048"/>
    <polygon style="fill: #000000" points="556.268,399.085 546.243,404.035 548.768,399.048 546.293,394.035 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="556.268,399.085 546.243,404.035 548.768,399.048 546.293,394.035 "/>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="432" y="296">
    <tspan x="432" y="296"></tspan>
  </text>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="409.5" y="390.6">
    <tspan x="409.5" y="390.6">Data (encrypted)</tspan>
  </text>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="357.504" y1="472.096" x2="549.768" y2="473.048"/>
    <polygon style="fill: #000000" points="557.268,473.085 547.243,478.035 549.768,473.048 547.293,468.035 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="557.268,473.085 547.243,478.035 549.768,473.048 547.293,468.035 "/>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="410.5" y="464.6">
    <tspan x="410.5" y="464.6">Data (encrypted)</tspan>
  </text>
  <text font-size="17.5994" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:700" x="447" y="555">
    <tspan x="447" y="555">...</tspan>
  </text>
  <g>
    <rect style="fill: #ffffff" x="267.576" y="410" width="76.85" height="54"/>
    <rect style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x="267.576" y="410" width="76.85" height="54"/>
    <text font-size="12.8" style="fill: #000000;text-anchor:middle;font-family:sans-serif;font-style:normal;font-weight:normal" x="306.001" y="433.8">
      <tspan x="306.001" y="433.8">Sleep</tspan>
      <tspan x="306.001" y="449.8">(optional)</tspan>
    </text>
  </g>
  <g>
    <line style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" x1="557.736" y1="486.976" x2="365.472" y2="486.024"/>
    <polygon style="fill: #000000" points="357.972,485.987 367.997,481.036 365.472,486.024 367.947,491.036 "/>
    <polygon style="fill: none; fill-opacity:0; stroke-width: 2; stroke: #000000" points="357.972,485.987 367.997,481.036 365.472,486.024 367.947,491.036 "/>
  </g>
  <text font-size="12.8" style="fill: #000000;text-anchor:start;font-family:sans-serif;font-style:normal;font-weight:normal" x="395" y="503">
    <tspan x="395" y="503">Downlink data (encrypted)</tspan>
  </text>
</svg>
